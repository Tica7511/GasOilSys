
<ul id="Galllist" class='nav'>
    <li>
        <a href='#' target='_self'>天然氣業者基本資料</a>
        <ul class='navSa'>
            <li><a name="menubtn" href="javascript:void(0);" link="GasInfo.aspx" target='_self'>事業單位基本資料表</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasTubeCheckPlanAndResult.aspx" target='_self'>用戶管線定期檢查計畫及檢查結果</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasAreaSchematicDiagram.aspx" target='_self'>轄區管線示意圖</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasStationFlowChart.aspx" target='_self'>場站管線流程圖(PFD)</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasStationAboutDistribution.aspx" target='_self'>場站概況分佈圖</a></li>
        </ul>
    </li>
    <li>
        <a name="menubtn" href="javascript:void(0);" link="GasStorageTankInfo.aspx" target="_self">儲槽設施資料</a>
    </li>
    <li>
        <a href='#' target='_self'>管線管理</a>
        <ul class='navSb'>
            <li><a name="menubtn" href="javascript:void(0);" link="GasTubeInfo.aspx" target='_self'>管線基本資料</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasTubeComplete.aspx" target='_self'>管線完整性管理作為</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasCheckSmartTubeCleaner.aspx" target='_self'>智慧型通管器檢查(ILI)</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasCIPS.aspx" target="_self">緊密電位檢測(CIPS)</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasUnusualRectifier.aspx" target="_self">異常整流站</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasTubeCheck.aspx" target='_self'>管線巡檢</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasTubeMaintain.aspx" target='_self'>管線維修或開挖</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasRiskAssessment.aspx" target='_self'>風險評估</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasInsideInspect.aspx" target='_self'>內部稽核</a></li>
        </ul>
    </li>
    <li><a name="menubtn" href="javascript:void(0);" link="GasControl.aspx" target='_self'>控制室</a></li>
    <li><a name="menubtn" href="javascript:void(0);" link="GasAccidentLearning.aspx" target='_self'>事故學習</a></li>
    <li><a name="menubtn" href="javascript:void(0);" link="GasSelfEvaluation.aspx" target='_self'>查核項目自評</a></li>
    <li><a name="menubtn" href="javascript:void(0);" link="GasReportUpload.aspx" target='_self'>查核簡報上傳</a></li>
    <li><a name="menubtn" href="javascript:void(0);" link="GasOnlineEvaluation.aspx" target='_self'>查核佐證資料上傳</a></li>
    <!--<li id="PipeManagementlist"><a name="PipeManagementbtn" href="javascript:void(0);" target="_blank">圖資查詢</a></li>-->
    <li class="Gconfirmlist"><a name="Gconfirmbtn" href="javascript:void(0);">資料確認</a></li>
</ul>

<ul id="Gnopipelist" class='nav'>
    <li>
        <a href='#' target='_self'>天然氣業者基本資料</a>
        <ul class='navSa'>
            <li><a name="menubtn" href="javascript:void(0);" link="GasInfo.aspx" target='_self'>事業單位基本資料表</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasTubeCheckPlanAndResult.aspx" target='_self'>用戶管線定期檢查計畫及檢查結果</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasAreaSchematicDiagram.aspx" target='_self'>轄區管線示意圖</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasStationFlowChart.aspx" target='_self'>場站管線流程圖(PFD)</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasStationAboutDistribution.aspx" target='_self'>場站概況分佈圖</a></li>
        </ul>
    </li>
    <li>
        <a href='#' target='_self'>管線管理</a>
        <ul class='navSb'>
            <li><a name="menubtn" href="javascript:void(0);" link="GasTubeInfo.aspx" target='_self'>管線基本資料</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasTubeComplete.aspx" target='_self'>管線完整性管理作為</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasCheckSmartTubeCleaner.aspx" target='_self'>智慧型通管器檢查(ILI)</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasCIPS.aspx" target="_self">緊密電位檢測(CIPS)</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasUnusualRectifier.aspx" target="_self">異常整流站</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasTubeCheck.aspx" target='_self'>管線巡檢</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasTubeMaintain.aspx" target='_self'>管線維修或開挖</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasRiskAssessment.aspx" target='_self'>風險評估</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasInsideInspect.aspx" target='_self'>內部稽核</a></li>
        </ul>
    </li>
    <li><a name="menubtn" href="javascript:void(0);" link="GasControl.aspx" target='_self'>控制室</a></li>
    <li><a name="menubtn" href="javascript:void(0);" link="GasAccidentLearning.aspx" target='_self'>事故學習</a></li>
    <li><a name="menubtn" href="javascript:void(0);" link="GasSelfEvaluation.aspx" target='_self'>查核項目自評</a></li>
    <li><a name="menubtn" href="javascript:void(0);" link="GasReportUpload.aspx" target='_self'>查核簡報上傳</a></li>
    <li><a name="menubtn" href="javascript:void(0);" link="GasOnlineEvaluation.aspx" target='_self'>查核佐證資料上傳</a></li>
    <!--<li id="PipeManagementlist"><a name="PipeManagementbtn" href="javascript:void(0);" target="_blank">圖資查詢</a></li>-->
    <li class="Gconfirmlist"><a name="Gconfirmbtn" href="javascript:void(0);">資料確認</a></li>
</ul>

<ul id="Gstoragelist" class='nav'>
    <li>
        <a href='#' target='_self'>天然氣業者基本資料</a>
        <ul class='navSa'>
            <li><a name="menubtn" href="javascript:void(0);" link="GasInfo.aspx" target='_self'>事業單位基本資料表</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasTubeCheckPlanAndResult.aspx" target='_self'>用戶管線定期檢查計畫及檢查結果</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasAreaSchematicDiagram.aspx" target='_self'>轄區管線示意圖</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasStationFlowChart.aspx" target='_self'>場站管線流程圖(PFD)</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasStationAboutDistribution.aspx" target='_self'>場站概況分佈圖</a></li>
        </ul>
    </li>
    <li>
        <a name="menubtn" href="javascript:void(0);" link="GasStorageTankInfo.aspx" target="_self">設施資料</a>
    </li>
    <li><a name="menubtn" href="javascript:void(0);" link="GasControl.aspx" target='_self'>控制室</a></li>
    <li><a name="menubtn" href="javascript:void(0);" link="GasAccidentLearning.aspx" target='_self'>事故學習</a></li>
    <li><a name="menubtn" href="javascript:void(0);" link="GasSelfEvaluation.aspx" target='_self'>查核項目自評</a></li>
    <li><a name="menubtn" href="javascript:void(0);" link="GasReportUpload.aspx" target='_self'>查核簡報上傳</a></li>
    <li><a name="menubtn" href="javascript:void(0);" link="GasOnlineEvaluation.aspx" target='_self'>查核佐證資料上傳</a></li>
    <!--<li id="PipeManagementlist"><a name="PipeManagementbtn" href="javascript:void(0);" target="_blank">圖資查詢</a></li>-->
    <li class="Gconfirmlist"><a name="Gconfirmbtn" href="javascript:void(0);">資料確認</a></li>
</ul>

<ul id="Gnonelist" class='nav'>
    <li>
        <a href='#' target='_self'>天然氣業者基本資料</a>
        <ul class='navSa'>
            <li><a name="menubtn" href="javascript:void(0);" link="GasInfo.aspx" target='_self'>事業單位基本資料表</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasTubeCheckPlanAndResult.aspx" target='_self'>用戶管線定期檢查計畫及檢查結果</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasAreaSchematicDiagram.aspx" target='_self'>轄區管線示意圖</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasStationFlowChart.aspx" target='_self'>場站管線流程圖(PFD)</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasStationAboutDistribution.aspx" target='_self'>場站概況分佈圖</a></li>
        </ul>
    </li>
    <li><a name="menubtn" href="javascript:void(0);" link="GasControl.aspx" target='_self'>控制室</a></li>
    <li><a name="menubtn" href="javascript:void(0);" link="GasAccidentLearning.aspx" target='_self'>事故學習</a></li>
    <li><a name="menubtn" href="javascript:void(0);" link="GasSelfEvaluation.aspx" target='_self'>查核項目自評</a></li>
    <li><a name="menubtn" href="javascript:void(0);" link="GasReportUpload.aspx" target='_self'>查核簡報上傳</a></li>
    <li><a name="menubtn" href="javascript:void(0);" link="GasOnlineEvaluation.aspx" target='_self'>查核佐證資料上傳</a></li>
    <!--<li id="PipeManagementlist"><a name="PipeManagementbtn" href="javascript:void(0);" target="_blank">圖資查詢</a></li>-->
    <li class="Gconfirmlist"><a name="Gconfirmbtn" href="javascript:void(0);">資料確認</a></li>
</ul>

<ul id="GOceanlist" class='nav'>
    <li>
        <a href='#' target='_self'>天然氣業者基本資料</a>
        <ul class='navSa'>
            <li><a name="menubtn" href="javascript:void(0);" link="GasInfo.aspx" target='_self'>事業單位基本資料表</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasAreaSchematicDiagram.aspx" target='_self'>轄區管線示意圖</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasStationFlowChart.aspx" target='_self'>場站管線流程圖(PFD)</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasStationAboutDistribution.aspx" target='_self'>場站概況分佈圖</a></li>
        </ul>
    </li>
    <li>
        <a href='#' target='_self'>管線管理</a>
        <ul class='navSb'>
            <li><a name="menubtn" href="javascript:void(0);" link="GasTubeInfo.aspx" target='_self'>管線基本資料</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasTubeComplete.aspx" target='_self'>管線完整性管理作為</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasCheckSmartTubeCleaner.aspx" target='_self'>智慧型通管器檢查(ILI)</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasCIPS.aspx" target="_self">緊密電位檢測(CIPS)</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasUnusualRectifier.aspx" target="_self">異常整流站</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasTubeCheck.aspx" target='_self'>管線巡檢</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasTubeMaintain.aspx" target='_self'>管線維修或開挖</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasRiskAssessment.aspx" target='_self'>風險評估</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasInsideInspect.aspx" target='_self'>內部稽核</a></li>
        </ul>
    </li>
    <li><a name="menubtn" href="javascript:void(0);" link="GasAccidentLearning.aspx" target='_self'>事故學習</a></li>
    <li><a name="menubtn" href="javascript:void(0);" link="GasSelfEvaluation.aspx" target='_self'>查核項目自評</a></li>
    <li><a name="menubtn" href="javascript:void(0);" link="GasReportUpload.aspx" target='_self'>查核簡報上傳</a></li>
    <li><a name="menubtn" href="javascript:void(0);" link="GasOnlineEvaluation.aspx" target='_self'>查核佐證資料上傳</a></li>
    <!--<li id="PipeManagementlist"><a name="PipeManagementbtn" href="javascript:void(0);" target="_blank">圖資查詢</a></li>-->
    <li class="Gconfirmlist"><a name="Gconfirmbtn" href="javascript:void(0);">資料確認</a></li>
</ul>

<ul id="GOceanlist2" class='nav'>
    <li>
        <a href='#' target='_self'>天然氣業者基本資料</a>
        <ul class='navSa'>
            <li><a name="menubtn" href="javascript:void(0);" link="GasInfo.aspx" target='_self'>事業單位基本資料表</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasTubeCheckPlanAndResult.aspx" target='_self'>用戶管線定期檢查計畫及檢查結果</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasAreaSchematicDiagram.aspx" target='_self'>轄區管線示意圖</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasStationFlowChart.aspx" target='_self'>場站管線流程圖(PFD)</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasStationAboutDistribution.aspx" target='_self'>場站概況分佈圖</a></li>
        </ul>
    </li>
    <li>
        <a href='#' target='_self'>管線管理</a>
        <ul class='navSb'>
            <li><a name="menubtn" href="javascript:void(0);" link="GasTubeInfo.aspx" target='_self'>管線基本資料</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasTubeComplete.aspx" target='_self'>管線完整性管理作為</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasCheckSmartTubeCleaner.aspx" target='_self'>智慧型通管器檢查(ILI)</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasCIPS.aspx" target="_self">緊密電位檢測(CIPS)</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasUnusualRectifier.aspx" target="_self">異常整流站</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasTubeCheck.aspx" target='_self'>管線巡檢</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasTubeMaintain.aspx" target='_self'>管線維修或開挖</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasRiskAssessment.aspx" target='_self'>風險評估</a></li>
            <li><a name="menubtn" href="javascript:void(0);" link="GasInsideInspect.aspx" target='_self'>內部稽核</a></li>
        </ul>
    </li>
    <li><a name="menubtn" href="javascript:void(0);" link="GasControl.aspx" target='_self'>控制室</a></li>
    <li><a name="menubtn" href="javascript:void(0);" link="GasAccidentLearning.aspx" target='_self'>事故學習</a></li>
    <li><a name="menubtn" href="javascript:void(0);" link="GasSelfEvaluation.aspx" target='_self'>查核項目自評</a></li>
    <li><a name="menubtn" href="javascript:void(0);" link="GasReportUpload.aspx" target='_self'>查核簡報上傳</a></li>
    <li><a name="menubtn" href="javascript:void(0);" link="GasOnlineEvaluation.aspx" target='_self'>查核佐證資料上傳</a></li>
    <!--<li id="PipeManagementlist"><a name="PipeManagementbtn" href="javascript:void(0);" target="_blank">圖資查詢</a></li>-->
    <li class="Gconfirmlist"><a name="Gconfirmbtn" href="javascript:void(0);">資料確認</a></li>
</ul>

<script type="text/javascript">
    $(document).ready(function () {

        $("a[name='Gconfirmbtn']").click(function () {
            if (confirm("是否確定資料都已正確?")) {

                // Create an FormData object 
                var data = new FormData();

                // If you want to add an extra field for the FormData
                data.append("type", "Gas");
                data.append("cpid", $.getQueryString("cp"));

                $.ajax({
                    type: "POST",
                    async: false, //在沒有返回值之前,不會執行下一步動作
                    url: "../handler/AddCompanyCheck.aspx",
                    data: data,
                    processData: false,
                    contentType: false,
                    cache: false,
                    error: function (xhr) {
                        alert("Error: " + xhr.status);
                        console.log(xhr.responseText);
                    },
                    success: function (data) {
                        if ($(data).find("Error").length > 0) {
                            alert($(data).find("Error").attr("Message"));
                        }
                        else {
                            alert($("Response", data).text());

                            location.href = "GasInfo.aspx?cp=" + $.getQueryString("cp");
                        }
                    }
                });
            }
        });

        $.ajax({
            type: "POST",
            async: false, //在沒有返回值之前,不會執行下一步動作
            url: "../Handler/GetCompanyName.aspx",
            data: {
                type: "Gas",
                cpid: $.getQueryString("cp"),
            },
            error: function (xhr) {
                alert("Error: " + xhr.status);
                console.log(xhr.responseText);
            },
            success: function (data) {
                if ($(data).find("Error").length > 0) {
                    alert($(data).find("Error").attr("Message"));
                }
                else {
                    if ($(data).find("data_item").length > 0) {
                        $(data).find("data_item").each(function (i) {
                            var cpid = $(this).children("guid").text().trim();
                            var pipeDisplay = $(this).children("管線管理不顯示").text().trim();
                            var storageDisplay = $(this).children("儲槽設施不顯示").text().trim();
                            var dataConfirm = $(this).children("資料是否確認").text().trim();
                            var competence = $(this).children("competence").text().trim();

                            if (cpid == 'A11B680E-4A42-45E0-BCE2-3B16679C0606') {
                                $("#Galllist").hide();
                                $("#Gnopipelist").hide();
                                $("#Gstoragelist").hide();
                                $("#Gnonelist").hide();
                                $("#GOceanlist").show();
                                $("#GOceanlist2").hide();
                            }
                            else if (cpid == 'C6AD982E-3E1E-47DA-856C-4EA98DA5E6CF') {
                                $("#Galllist").hide();
                                $("#Gnopipelist").hide();
                                $("#Gstoragelist").hide();
                                $("#Gnonelist").hide();
                                $("#GOceanlist").hide();
                                $("#GOceanlist2").show();
                            }
                            else {
                                if ((pipeDisplay == 'N') && (storageDisplay == 'N')) {
                                    $("#Galllist").hide();
                                    $("#Gnopipelist").hide();
                                    $("#Gstoragelist").hide();
                                    $("#Gnonelist").show();
                                    $("#GOceanlist").hide();
                                    $("#GOceanlist2").hide();
                                }
                                else if ((pipeDisplay == 'N') && (storageDisplay != 'N')) {
                                    $("#Galllist").hide();
                                    $("#Gnopipelist").hide();
                                    $("#Gstoragelist").show();
                                    $("#Gnonelist").hide();
                                    $("#GOceanlist").hide();
                                    $("#GOceanlist2").hide();
                                }
                                else if ((pipeDisplay != 'N') && (storageDisplay == 'N')) {
                                    $("#Galllist").hide();
                                    $("#Gnopipelist").show();
                                    $("#Gstoragelist").hide();
                                    $("#Gnonelist").hide();
                                    $("#GOceanlist").hide();
                                    $("#GOceanlist2").hide();
                                }
                                else {
                                    $("#Galllist").show();
                                    $("#Gnopipelist").hide();
                                    $("#Gstoragelist").hide();
                                    $("#Gnonelist").hide();
                                    $("#GOceanlist").hide();
                                    $("#GOceanlist2").hide();
                                }
                            }

                            if (dataConfirm == '是' || competence == '01')
                                $(".Gconfirmlist").empty();
                        });
                    }
                }
            }
        });

        $.ajax({
            type: "POST",
            async: false, //在沒有返回值之前,不會執行下一步動作
            url: "../Handler/GetCompanyName.aspx",
            data: {
                type: "Gas",
                cpid: $.getQueryString("cp"),
            },
            error: function (xhr) {
                alert("Error: " + xhr.status);
                console.log(xhr.responseText);
            },
            success: function (data) {
                if ($(data).find("Error").length > 0) {
                    alert($(data).find("Error").attr("Message"));
                }
                else {
                    if ($(data).find("data_item2").length > 0) {

                        $(data).find("data_item2").each(function (i) {
                            $("#PipeManagementlist").show();
                            $("a[name='PipeManagementbtn']").attr("href", "http://23.99.109.107/ncree2/home/map.aspx?sta=" + $(this).children("場站").text().trim());
                        });
                    }
                    else {
                        $("#PipeManagementlist").hide();
                    }
                }
            }
        });

        var pathAry = window.location.pathname.split('/');
        var pathName = pathAry[(pathAry.length - 1)];
        var pathNameAry = pathName.split('_');
        var pathParentName = '';
        if (pathNameAry.length > 2)
            pathParentName = pathNameAry[(pathNameAry.length - 2)] + ".aspx";
        else
            pathParentName = pathNameAry[(pathNameAry.length - 1)];

        $("#navmenuV a[link='" + pathParentName + "']").parent().addClass("active");
        $("#navmenuV a[link='" + pathParentName + "']").parent().parent().parent().addClass("open");
        $('.nav').navgoco();

        $("a[name='menubtn']").click(function () {
            location.href = ($.getQueryString("cp") != "") ? $(this).attr("link") + "?cp=" + $.getQueryString("cp") : $(this).attr("link");
        });
	});
</script>